{# src/UserManagementBundle/Resources/views/form/new.html.twig #}

{% extends 'base.html.twig' %}

{% block body %}
{{ form_start(form, {'attr':{'novalidate' : 'novalidate','onsubmit':'return validation();','id':'myform'}}) }}
<table>
    <tr>
        <td>
            {{ form_label(form.username) }}
        </td>
        <td>
            <p class="widget">{{ form_widget(form.username) }}</p>
            <span class="error">{{ form_errors(form.username) }}</span>
        </td>
    </tr>
    <tr>
        <td>
            {{ form_label(form.firstname) }}
        </td>
        <td>
            <p class="widget">{{ form_widget(form.firstname) }}</p>
            <span class="error">{{ form_errors(form.firstname) }}</span>
        </td>
    </tr>
    <tr>
        <td>
            {{ form_label(form.lastname) }}
        </td>
        <td>
            <p class="widget">{{ form_widget(form.lastname) }}</p>
            <span class="error">{{ form_errors(form.lastname) }}</span>
        </td>
    </tr>
    <tr>
        <td>
            {{ form_label(form.gender) }}
        </td>
        <td>
            <p class="widget">{{ form_widget(form.gender) }}</p>
            <span class="error">{{ form_errors(form.gender) }}</span>
        </td>
    </tr>
    <tr>
        <td>
            {{ form_label(form.blood) }}
        </td>
        <td>
            <p class="widget">{{ form_widget(form.blood) }}</p>
            <span class="error">{{ form_errors(form.blood) }}</span>
        </td>
    </tr>
    <tr>
        <td>
            {{ form_label(form.dob) }}
        </td>
        <td>
            <p class="widget">{{ form_widget(form.dob) }}</p>
            <span class="error">{{ form_errors(form.dob) }}</span>
        </td>
    </tr>
  
    <tr>
        <td>
            {{ form_label(form.emails) }}
        </td>
        <td>

        <ul id="email-fields-list"
            data-prototype="{{ form_widget(form.emails.vars.prototype)|e }}">
            {% for emailField in form.emails %}
                <p>
                    <p class="widget">{{ form_widget(emailField) }}<p>
                    <span class="error">{{ form_errors(emailField) }}</span>
                </p>
            {% endfor %}
        </ul>
        </td>
    </tr>
    <tr>
        <td>
        <a href="#" id="add-another-email" onclick="addField('email-fields-list')">Add another email</a>
        </td>
        <td></td>
    </tr>
    <tr>
        <td>
            {{ form_label(form.mobileNumbers) }}
        </td>
        <td>

        <ul id="mobile-numbers-list"
            data-prototype="{{ form_widget(form.mobileNumbers.vars.prototype)|e }}">
            {% for mobileField in form.mobileNumbers %}
                <p>
                    <p class="widget">{{ form_widget(mobileField) }}</p>
                    <span class="error">{{ form_errors(mobileField) }}</span>

                </p>
            {% endfor %}
        </ul>
        </td>
    </tr>
    <tr>
        <td>
        <a href="#" id="add-another-number" onclick="addField('mobile-numbers-list')">Add another Number</a>
        </td>
        <td></td>
    </tr>
    <tr>
        <td>
            {{ form_label(form.education) }}
        </td>
        <td>

        <ul id="education-list"
            data-prototype="{{ form_widget(form.education.vars.prototype)|e }}">
            {% for edu in form.education %}
                <p>
                    <p class="widget">{{ form_widget(edu.eduType) }}</p>
                    <span class="error">{{ form_errors(edu.eduType) }}</span>
                    <p class="widget">{{ form_widget(edu.institute, {'attr':{'placeholder': 'Institute'}}) }}</p>
                    <span class="error">{{ form_errors(edu.institute) }}</span>
                </p>
            {% endfor %}
        </ul>
        </td>
    </tr>
    <tr>
        <td>
        <a href="#" id="add-another-education" onclick="addField('education-list')">Add another Education</a>
        </td>
        <td></td>
    </tr>
    
    <tr>
        <td>
            {{ form_label(form.interests) }}
        </td>
        <td>

        <ul id="interests-list"
            data-prototype="{{ form_widget(form.interests.vars.prototype)|e }}">
            {% for interestfield in form.interests %}
                <p>
                    <p class="widget">{{ form_widget(interestfield.interest) }}</p>
                    <span class="error">{{ form_errors(interestfield.interest) }}</span>
                </p>
            {% endfor %}
        </ul>
        </td>
    </tr>
    <tr>
        <td>
        <a href="#" id="add-another-interest" onclick="addField('interests-list')">Add another interest</a>
        </td>
        <td></td>
    </tr>
    <tr>
        <td>
        </td>
        <td>
            {{ form_row(form.save) }}
        </td>
    </tr>
    </table>
            {{ form_row(form._token) }}

{{ form_end(form, {'render_rest': false}) }}
{% endblock %}


{% block javascripts %}
{#    {{ parent() }}#}
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.2.1/jquery.min.js">
    </script>
    <script src="https://code.jquery.com/ui/1.12.1/jquery-ui.js"></script>
    <link rel="stylesheet" href="//code.jquery.com/ui/1.12.1/themes/base/jquery-ui.css">
    <script src="https://cdn.jsdelivr.net/npm/jquery-validation@1.17.0/dist/jquery.validate.min.js">
    </script>
    <script src="https://cdn.jsdelivr.net/npm/jquery-validation@1.17.0/dist/additional-methods.min.js">
    </script>
    <script src="{{ asset('bundles/usermanagement/js/addRemoveField.js') }}">    
    </script>
    {#<script src="{{ asset('bundles/usermanagement/js/validation2.js') }}">
    </script>#}
    <script>
        $(document).ready(function() {
            var today = new Date();
            var currentYear = today.getFullYear();
            //var rangeLimit = currentYear-18;
            $( ".js-datepicker" ).datepicker({
                changeMonth: true,
                changeYear: true,
                yearRange: '1980:'+currentYear,
            });
        });
    </script>
    <script>
        $(document).ready(function () {
            $("#myform").validate({
                rules: {
                    'user[username]': {
                        required: true,
                        pattern: /^(\w+)$/,
                    },
                    'user[firstname]': {
                        required: true,
                        pattern: /^([a-zA-Z]+)([ \.-][a-zA-Z]+)?$/,
                    },
                    'user[lastname]': {
                        required: false,
                        pattern: /^([a-zA-Z]+)([ \.-][a-zA-Z]+)?$/,
                    },
                    'user[dob]': {
                        required: true,
                        pattern: /^[\d]{2}[/][\d]{2}[/][\d]{4}$/,
                    },
                    '{{ form.blood.vars.full_name }}': {
                         required: true,
                     }, 
                  },
                messages: {
                    'user[username]': {
                        required: "Please enter your username",
                        pattern: "Please enter valid username"
                    },
                    'user[firstname]': {
                        required: "Please enter your firstname",
                        pattern: "Please enter valid firstname"
                    },
                    'user[lastname]': {
                        pattern: "Please enter valid lastname"
                    },
                    'user[dob]': {
                        required: "Please enter your dob",
                        pattern: "Please enter valid dob",
                    },
                    '{{ form.blood.vars.full_name }}': {
                        required: "Please select Blood group",
                    }, 
                  }        
            });
            
            {#$('.email_id').each(function() {
                $(this).rules('add', {
                    required: true,
                    pattern: /^\w+([\.-]?\w+)*@\w+([\.-]?\w+)*(\.\w{2,3})+$/,
                    messages: {
                        required: "Please enter your email",
                        pattern: "Please enter valid email"
                    }
                });
            });#}

            $('.phone_number').each(function() {
                $(this).rules('add', {
                    required: true,
                    pattern: /^([9|8|7])[\d]{9}$/,
                    messages: {
                        required: "Please enter your mobile number",
                        pattern: "Please enter valid mobile number",            }
                });
            });
            '[name*="field"]'
           {# $.validator.addMethod("cRequired", $.validator.methods.required,
            "email required");
#}
            jQuery.validator.addClassRules({
                "email_id": {
                    required: true,
                    pattern: /^\w+([\.-]?\w+)*@\w+([\.-]?\w+)*(\.\w{2,3})+$/,
                },
                "education_type": {
                    required: true,
                },
                "interest_area": {
                    required: true,
                },
                "institute": {
                    required: true,
                    pattern: /^[A-z]+$/,
                },
            });
        });
    </script>
    
{% endblock %}
{% block stylesheets %}
    <style>
        
        div.email_id, div.phone_number, div.education_type, div.interest_area {
            display:inline-block;
        }
        .error {
            color: red;
        }
        form {
            padding:20px 20px;
            text-align: center;
        }
        {#td, th {
            width :400px;
            height: auto;
            padding:5px;

        }#}
        input[type=text], input[type=email] {
            width: 100%;
            padding: 10px 10px;
            margin: 8px 0;
            box-sizing: border-box;
        }
        input[type=submit] {
            background-color: #4CAF50;
            border: none;
            color: white;
            padding: 16px 32px;
            text-decoration: none;
            margin: 4px 2px;
            cursor: pointer;
        }
        select {
            width: 50%;
            height:20px;
        }

    </style>
{% endblock %}
        